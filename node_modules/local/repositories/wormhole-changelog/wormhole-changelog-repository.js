'use strict';

var baseRepository = require('../base');

var Log = function (id, data) {
    this.id = id;
    this.state = data.state;
    this.lastModified = data.mod;
}

var base = baseRepository({
    path: 'wormhole-changelogs',
    makeLocal: function (id, data) {
        return new Log(id, data);
    },
    makeRemote: function (local) {
        var json = {
            state: local.state,
            mod: new Date().getTime()
        }
        return json;
    }
});

var me = {
    get: base.get,
    getAll: base.getAll,
    getArray: base.getArray,
    //create: base.create,
    //update: base.update,
    'delete': base.delete,
    changed: base.changed,
    changedRemoveHandler: base.changedRemoveHandler,
    initialize: base.initialize,
    supressChanged: base.supressChanged
};
me.set = function (wormholeId, state) {
    var itm = new Log(wormholeId, {
        state: state
    });
    base.update(itm);
}

module.exports = me;
