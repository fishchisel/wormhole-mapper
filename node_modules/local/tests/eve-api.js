'use strict';

var expect = require('chai').expect;

var charInfo = require('../eve-api/character-info'),
    entitySearch = require('../eve-api/entity-search');

describe('Eve Api Character Info', function () {

    it("Fails on empty character Id", function (done) {

        charInfo().fail(function (message) {
            done();
        })
    });

    it("Success on valid character Id", function (done) {

        charInfo(93563522).then(function (res) {
            expect(res.name).equals("Pish-Tush");
            done();
        });
    });

    it("Can query twice", function (done) {
        charInfo(93563522).then(function (res) {
            expect(res.name).equals("Pish-Tush");
        }).then(function () {
            return charInfo(93563522);
        }).then(function (res) {
            expect(res.name).equals("Pish-Tush");
            done();
        });

    });

});

describe('Eve Api Entity Search', function () {

    it("No result on empty query", function (done) {
        entitySearch("").then(function (result) {
            expect(result).equals(null);
            done();
        });

    });

    it("No result on invalid query", function (done) {
        entitySearch("$a_").then(function (result) {
            expect(result).equals(null);
            done();
        });
    });

    it("Character on character query", function (done) {
        entitySearch("olixia castitatis").then(function (result) {
            expect(result.id).equals(935603363);
            expect(result.name).equals("Olixia Castitatis");
            expect(result.type).equals("character");
            done();
        });
    });

    it("Corporation on corporation query", function (done) {
        entitySearch("beyond divinity inc").then(function (result) {
            expect(result.id).equals(430577669);
            expect(result.type).equals("corporation");
            done();

        });
    });

    it("Alliance on alliance query", function (done) {
        entitySearch("shadow cartel").then(function (result) {
            expect(result.type).equals("alliance");
            done();

        });
    });


});